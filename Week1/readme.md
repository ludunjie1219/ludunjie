# Week1 GCN

## 代码阅读与理解：
### 代码框架：
* **model.py**

    这是一个简单的图卷积网络（GCN）模型的实现。以下是代码的结构和主要部分的解释：
    
    1. GCN类定义:
    - `GCN`类继承了`nn.Module`，这是PyTorch中所有神经网络模型的基类。
    - 在`__init__`方法中，定义了模型的层：
        - `self.gc1`：第一个图卷积层，它将输入特征转换为隐藏层特征。
        - `self.gc2`：第二个图卷积层，它将隐藏层特征转换为输出类别。
        - `self.dropout`：dropout率，用于正则化和防止过拟合。
    2. 前向传播:
    - `forward`方法定义了模型的前向传播。
    - 输入`x`是节点的特征，`adj`是图的邻接矩阵。
    - 首先，通过第一个图卷积层`gc1`并应用ReLU激活函数。
    - 接着，应用dropout。
    - 然后，通过第二个图卷积层`gc2`。
    - 最后，应用`log_softmax`激活函数，使输出适合多类分类。

* **layers.py**

    这是一个图卷积层（Graph Convolution Layer）的实现。以下是代码的结构和主要部分的解释：
    1. **GraphConvolution类定义**:
    - `GraphConvolution`类继承了`Module`。
    - 它的构造函数`__init__`接受输入特征的数量、输出特征的数量和一个可选的偏置参数。
    - `self.weight`：这是一个可训练的参数，表示该层的权重。
    - `self.bias`：这是一个可选的可训练参数，表示该层的偏置。
    2. **参数初始化**:
    - `reset_parameters`方法用于初始化权重和偏置。它使用均匀分布来随机初始化这些参数。
    3. **前向传播**:
    - `forward`方法定义了层的前向传播。
    - 输入`input`是节点的特征，`adj`是图的邻接矩阵。
    - 首先，通过矩阵乘法计算`support`，这是输入特征和权重的乘积。
    - 然后，使用稀疏矩阵乘法`torch.spmm`计算`output`，这是邻接矩阵和`support`的乘积。
    - 如果定义了偏置，将其添加到输出中。
    4. **字符串表示**:
    - `__repr__`方法返回该层的字符串表示，这在打印模型时很有用。

    总的来说，这是图卷积网络（GCN）中的基本层。它实现了一个简单的图卷积操作，类似于week1中GCN论文中描述的操作。这个层可以用于构建更复杂的GCN模型。

* **train.py**

    这段代码是一个使用图卷积网络（GCN）进行节点分类的简单实现。以下是代码的结构和主要部分的解释：

    1. **命令行参数解析**:
    使用`argparse`库来解析命令行参数，这些参数包括是否使用CUDA、学习率、权重衰减、隐藏层单元数、dropout率等。
    2. **设置随机种子**:
    为了确保实验的可重复性，设置了numpy和torch的随机种子。
    3. **加载数据**:
    使用`load_data`函数从`pygcn.utils`加载数据。这些数据包括邻接矩阵、特征、标签以及训练、验证和测试的索引。
    4. **模型和优化器**:
    - 使用`GCN`类从`pygcn.models`初始化图卷积网络模型。
    - 使用Adam优化器。
    6. **数据和模型的CUDA设置**:
    如果CUDA可用并且用户没有禁用它，那么数据和模型都会被移动到GPU上。
    7. **训练函数**:
    `train`函数执行以下操作：
    - 设置模型为训练模式。
    - 进行前向传播。
    - 计算损失和准确率。
    - 执行反向传播和优化。
    - 如果不在快速模式下，它还会评估验证集的性能
    8. **测试函数**:
    `test`函数评估模型在测试集上的性能。
    9. **模型训练**:
    在所有训练数据上进行多个周期的训练。
    10. **测试**:
    在所有测试数据上评估模型。

    总的来说，这段代码为图上的节点分类任务提供了一个简单的GCN实现。它首先加载数据，然后初始化模型和优化器，接着进行多个周期的训练，并最后在测试集上评估模型的性能。


## 运行结果：
### 在cora数据集上的表现：
* |运行次数|第一次|第二次|第三次|第四次|第五次|平均|
    |-|-|-|-|-|-|-|
    |准确率|0.8370|0.8180|0.8300|0.8380|0.8350|0.8316
### 在citeseer数据集上的表现：
* |运行次数|第一次|第二次|第三次|第四次|第五次|平均|
    |-|-|-|-|-|-|-|
    |准确率|0.7020|0.7040|0.6970|0.7050|0.7030|0.7022
### 在pumbed数据集上的表现：
* |运行次数|第一次|第二次|第三次|第四次|第五次|平均|
    |-|-|-|-|-|-|-|
    |准确率|0.7980|0.7870|0.7940|0.7810|0.7950|0.7910		